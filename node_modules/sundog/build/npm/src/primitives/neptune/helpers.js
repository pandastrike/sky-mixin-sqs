"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.range = exports.upsert = exports.default = void 0;

var _pandaGarden = require("panda-garden");

var _pandaParchment = require("panda-parchment");

//import {applyConfiguration} from "../lift"
var range,
    upsert,
    indexOf = [].indexOf;
exports.upsert = upsert;
exports.range = range;
// Enforce the data model via an allowlist of fields.
exports.upsert = upsert = (0, _pandaGarden.curry)(function (allowedProperties, data) {
  var name, query, value;
  query = "";

  for (name in data) {
    value = data[name];

    if (indexOf.call((0, _pandaParchment.keys)(allowedProperties), name) >= 0) {
      switch (allowedProperties[name]) {
        case "string":
          query += `.property('${name}', '${value}')`;
          break;

        case "integer":
          query += `.property('${name}', ${value})`;
          break;

        default:
          throw new Error(`Unable to upsert field '${name}'. Unknown Neptune datatype, '${value}'`);
      }
    }
  }

  return query;
});
exports.range = range = (0, _pandaGarden.curry)(function (pageSize, page) {
  var end, start;
  start = pageSize * page;
  end = pageSize * (page + 1);
  return `range(${start}, ${end})`;
});
var _default = {
  upsert,
  range
};
exports.default = _default;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9kYXZpZC9yZXBvcy9zdW5kb2cvc3JjL3ByaW1pdGl2ZXMvbmVwdHVuZS9oZWxwZXJzLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQ0E7O0FBQ0E7O0FBRkE7QUFBQSxJQUFBLEtBQUE7QUFBQSxJQUFBLE1BQUE7QUFBQSxJQUFBLE9BQUEsR0FBQSxHQUFBLE9BQUE7Ozs7QUFLQSxpQkFBQSxNQUFBLEdBQVMsd0JBQU0sVUFBQSxpQkFBQSxFQUFBLElBQUEsRUFBQTtBQUNiLE1BQUEsSUFBQSxFQUFBLEtBQUEsRUFBQSxLQUFBO0FBQUEsRUFBQSxLQUFBLEdBQVEsRUFBUjs7QUFDQSxPQUFBLElBQUEsSUFBQSxJQUFBLEVBQUE7OztRQUE2QixPQUFBLENBQUEsSUFBQSxDQUFRLDBCQUFSLGlCQUFRLENBQVIsRUFBQSxJQUFBLEtBQUEsQyxFQUFBO0FBQzNCLGNBQU8saUJBQWtCLENBQXpCLElBQXlCLENBQXpCO0FBQUEsYUFBQSxRQUFBO0FBRUksVUFBQSxLQUFBLElBQVMsY0FBQSxJQUFBLE9BQUEsS0FBQSxJQUFUO0FBREc7O0FBRFAsYUFBQSxTQUFBO0FBSUksVUFBQSxLQUFBLElBQVMsY0FBQSxJQUFBLE1BQUEsS0FBQSxHQUFUO0FBREc7O0FBSFA7QUFNSSxnQkFBTSxJQUFBLEtBQUEsQ0FBVSwyQkFBQSxJQUFBLGlDQUFBLEtBQVYsR0FBQSxDQUFOO0FBTko7O0FBREY7O1NBUUEsSztBQVZPLENBQUEsQ0FBVDtBQVlBLGdCQUFBLEtBQUEsR0FBUSx3QkFBTSxVQUFBLFFBQUEsRUFBQSxJQUFBLEVBQUE7QUFDWixNQUFBLEdBQUEsRUFBQSxLQUFBO0FBQUEsRUFBQSxLQUFBLEdBQVEsUUFBQSxHQUFXLElBQW5CO0FBQ0EsRUFBQSxHQUFBLEdBQU0sUUFBQSxJQUFZLElBQUEsR0FBRCxDQUFYLENBQU47QUFDQSxTQUFBLFNBQUEsS0FBQSxLQUFBLEdBQUEsR0FBQTtBQUhNLENBQUEsQ0FBUjtlQU1lO0FBQUEsRUFBQSxNQUFBO0FBQUEsRUFBQTtBQUFBLEMiLCJzb3VyY2VzQ29udGVudCI6WyIjaW1wb3J0IHthcHBseUNvbmZpZ3VyYXRpb259IGZyb20gXCIuLi9saWZ0XCJcbmltcG9ydCB7Y3Vycnl9IGZyb20gXCJwYW5kYS1nYXJkZW5cIlxuaW1wb3J0IHtrZXlzLCB2YWx1ZXN9IGZyb20gXCJwYW5kYS1wYXJjaG1lbnRcIlxuXG4jIEVuZm9yY2UgdGhlIGRhdGEgbW9kZWwgdmlhIGFuIGFsbG93bGlzdCBvZiBmaWVsZHMuXG51cHNlcnQgPSBjdXJyeSAoYWxsb3dlZFByb3BlcnRpZXMsIGRhdGEpIC0+XG4gIHF1ZXJ5ID0gXCJcIlxuICBmb3IgbmFtZSwgdmFsdWUgb2YgZGF0YSB3aGVuIG5hbWUgaW4ga2V5cyBhbGxvd2VkUHJvcGVydGllc1xuICAgIHN3aXRjaCBhbGxvd2VkUHJvcGVydGllc1tuYW1lXVxuICAgICAgd2hlbiBcInN0cmluZ1wiXG4gICAgICAgIHF1ZXJ5ICs9IFwiLnByb3BlcnR5KCcje25hbWV9JywgJyN7dmFsdWV9JylcIlxuICAgICAgd2hlbiBcImludGVnZXJcIlxuICAgICAgICBxdWVyeSArPSBcIi5wcm9wZXJ0eSgnI3tuYW1lfScsICN7dmFsdWV9KVwiXG4gICAgICBlbHNlXG4gICAgICAgIHRocm93IG5ldyBFcnJvciBcIlVuYWJsZSB0byB1cHNlcnQgZmllbGQgJyN7bmFtZX0nLiBVbmtub3duIE5lcHR1bmUgZGF0YXR5cGUsICcje3ZhbHVlfSdcIlxuICBxdWVyeVxuXG5yYW5nZSA9IGN1cnJ5IChwYWdlU2l6ZSwgcGFnZSkgLT5cbiAgc3RhcnQgPSBwYWdlU2l6ZSAqIHBhZ2VcbiAgZW5kID0gcGFnZVNpemUgKiAocGFnZSArIDEpXG4gIFwicmFuZ2UoI3tzdGFydH0sICN7ZW5kfSlcIlxuXG5cbmV4cG9ydCBkZWZhdWx0IHt1cHNlcnQsIHJhbmdlfVxuZXhwb3J0IHt1cHNlcnQsIHJhbmdlfVxuIl0sInNvdXJjZVJvb3QiOiIifQ==
//# sourceURL=/Users/david/repos/sundog/src/primitives/neptune/helpers.coffee