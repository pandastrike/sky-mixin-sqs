"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.applyConfiguration = exports.liftService = void 0;

var _pandaParchment = require("panda-parchment");

var applyConfiguration, callback, lift, liftService, promise;
exports.liftService = liftService;
exports.applyConfiguration = applyConfiguration;

promise = function (f) {
  return new Promise(f);
};

callback = function (resolve, reject) {
  return [function (error, ...args) {
    if (error) {
      return reject(error);
    } else {
      return resolve(...args);
    }
  }];
};

lift = function (f) {
  return function (...args) {
    return promise(function (resolve, reject) {
      var error;

      try {
        return f(...args, ...callback(resolve, reject));
      } catch (error1) {
        error = error1;
        return reject(error);
      }
    });
  };
};

exports.liftService = liftService = function (s) {
  var k, service, v;
  service = {};

  for (k in s) {
    v = s[k];
    service[k] = (0, _pandaParchment.isFunction)(v) ? lift((0, _pandaParchment.bind)(v, s)) : v;
  }

  return service;
};

exports.applyConfiguration = applyConfiguration = function (configuration, service) {
  if (configuration) {
    return liftService(new service(configuration));
  } else {
    return liftService(new service());
  }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9kYXZpZC9yZXBvcy9zdW5kb2cvc3JjL2xpZnQuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFBQSxJQUFBLGtCQUFBLEVBQUEsUUFBQSxFQUFBLElBQUEsRUFBQSxXQUFBLEVBQUEsT0FBQTs7OztBQUVBLE9BQUEsR0FBVSxVQUFBLENBQUEsRUFBQTtTQUFPLElBQUEsT0FBQSxDQUFBLENBQUEsQztBQUFQLENBQVY7O0FBRUEsUUFBQSxHQUFXLFVBQUEsT0FBQSxFQUFBLE1BQUEsRUFBQTtTQUFxQixDQUM1QixVQUFBLEtBQUEsRUFBQSxHQUFBLElBQUEsRUFBQTtBQUNFLFFBQUEsS0FBQSxFQUFBO2FBQWUsTUFBQSxDQUFmLEtBQWUsQztBQUFmLEtBQUEsTUFBQTthQUFtQyxPQUFBLENBQVEsR0FBM0MsSUFBbUMsQzs7QUFGVCxHQUFBLEM7QUFBckIsQ0FBWDs7QUFLQSxJQUFBLEdBQU8sVUFBQSxDQUFBLEVBQUE7U0FDTCxVQUFBLEdBQUEsSUFBQSxFQUFBO1dBQ0ksT0FBQSxDQUFRLFVBQUEsT0FBQSxFQUFBLE1BQUEsRUFBQTtBQUNOLFVBQUEsS0FBQTs7QUFBQSxVQUFBO2VBQ0UsQ0FBQSxDQUFFLEdBQUYsSUFBQSxFQUFXLEdBQUMsUUFBQSxDQUFBLE9BQUEsRUFEZCxNQUNjLENBQVosQztBQURGLE9BQUEsQ0FBQSxPQUFBLE1BQUEsRUFBQTtBQUVNLFFBQUEsS0FBQSxHQUFBLE1BQUE7ZUFDSixNQUFBLENBSEYsS0FHRSxDOztBQUpKLEtBQUEsQztBQURKLEc7QUFESyxDQUFQOztBQVFBLHNCQUFBLFdBQUEsR0FBYyxVQUFBLENBQUEsRUFBQTtBQUNaLE1BQUEsQ0FBQSxFQUFBLE9BQUEsRUFBQSxDQUFBO0FBQUEsRUFBQSxPQUFBLEdBQVUsRUFBVjs7QUFDQSxPQUFBLENBQUEsSUFBQSxDQUFBLEVBQUE7O0FBQ0UsSUFBQSxPQUFRLENBQVIsQ0FBUSxDQUFSLEdBQWdCLGdDQUFILENBQUcsSUFBa0IsSUFBQSxDQUFLLDBCQUFBLENBQUEsRUFBMUIsQ0FBMEIsQ0FBTCxDQUFsQixHQUFzQyxDQUF0RDtBQURGOztTQUVBLE87QUFKWSxDQUFkOztBQU1BLDZCQUFBLGtCQUFBLEdBQXFCLFVBQUEsYUFBQSxFQUFBLE9BQUEsRUFBQTtBQUNuQixNQUFBLGFBQUEsRUFBQTtXQUNFLFdBQUEsQ0FBWSxJQUFBLE9BQUEsQ0FEZCxhQUNjLENBQVosQztBQURGLEdBQUEsTUFBQTtXQUdFLFdBQUEsQ0FBWSxJQUhkLE9BR2MsRUFBWixDOztBQUppQixDQUFyQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aXNGdW5jdGlvbiwgYmluZH0gZnJvbSBcInBhbmRhLXBhcmNobWVudFwiXG5cbnByb21pc2UgPSAoZikgLT4gbmV3IFByb21pc2UgZlxuXG5jYWxsYmFjayA9IChyZXNvbHZlLCByZWplY3QpIC0+IFtcbiAgICAoZXJyb3IsIGFyZ3MuLi4pIC0+XG4gICAgICBpZiBlcnJvciB0aGVuIChyZWplY3QgZXJyb3IpIGVsc2UgKHJlc29sdmUgYXJncy4uLilcbiAgXVxuXG5saWZ0ID0gKGYpIC0+XG4gIChhcmdzLi4uKSAtPlxuICAgICAgcHJvbWlzZSAocmVzb2x2ZSwgcmVqZWN0KSAtPlxuICAgICAgICB0cnlcbiAgICAgICAgICBmIGFyZ3MuLi4sIChjYWxsYmFjayByZXNvbHZlLCByZWplY3QpLi4uXG4gICAgICAgIGNhdGNoIGVycm9yXG4gICAgICAgICAgcmVqZWN0IGVycm9yXG5cbmxpZnRTZXJ2aWNlID0gKHMpIC0+XG4gIHNlcnZpY2UgPSB7fVxuICBmb3IgaywgdiBvZiBzXG4gICAgc2VydmljZVtrXSA9IGlmIGlzRnVuY3Rpb24gdiB0aGVuIGxpZnQgYmluZCB2LCBzIGVsc2UgdlxuICBzZXJ2aWNlXG5cbmFwcGx5Q29uZmlndXJhdGlvbiA9IChjb25maWd1cmF0aW9uLCBzZXJ2aWNlKSAtPlxuICBpZiBjb25maWd1cmF0aW9uXG4gICAgbGlmdFNlcnZpY2UgbmV3IHNlcnZpY2UgY29uZmlndXJhdGlvblxuICBlbHNlXG4gICAgbGlmdFNlcnZpY2UgbmV3IHNlcnZpY2UoKVxuXG5leHBvcnQge2xpZnRTZXJ2aWNlLCBhcHBseUNvbmZpZ3VyYXRpb259XG4iXSwic291cmNlUm9vdCI6IiJ9
//# sourceURL=/Users/david/repos/sundog/src/lift.coffee