var Amen, assert, next, observe, promise, value;
assert = require("assert");
Amen = require("amen");
({
  promise
} = require("panda-parchment"));
({
  next,
  value
} = require("../src/iterator"));
({
  observe
} = require("../src/observe"));
Amen.describe("Observe", function (context) {
  return context.test("change events", function* () {
    var proxy, reactor;
    ({
      proxy,
      reactor
    } = observe({
      value: 7
    }));
    setImmediate(function () {
      return proxy.value = 3;
    });
    assert.deepEqual({
      value: 3
    }, value((yield next(reactor))));

    (function (proxy, reactor) {
      return context.test("nested change events", function* () {
        ({
          proxy,
          reactor
        } = observe({
          value: {
            value: 7
          }
        }));
        setImmediate(function () {
          return proxy.value.value = 5;
        });
        return assert.deepEqual({
          value: {
            value: 5
          }
        }, value((yield next(reactor))));
      });
    })(proxy, reactor);

    return function (proxy, reactor) {
      return context.test("for arrays", function* () {
        ({
          proxy,
          reactor
        } = observe([1, 2, 3, 4, 5]));
        setImmediate(function () {
          return proxy.shift();
        });
        return assert.deepEqual([2, 3, 4, 5], value((yield next(reactor))));
      });
    }(proxy, reactor);
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9keW9kZXIvcmVwb3MvcGFuZGEtcml2ZXIvdGVzdC9vYnNlcnZlLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFBLElBQUEsRUFBQSxNQUFBLEVBQUEsSUFBQSxFQUFBLE9BQUEsRUFBQSxPQUFBLEVBQUEsS0FBQTtBQUFBLE1BQUEsR0FBUyxPQUFBLENBQUEsUUFBQSxDQUFUO0FBQ0EsSUFBQSxHQUFPLE9BQUEsQ0FBQSxNQUFBLENBQVA7QUFDQSxDQUFBO0FBQUEsRUFBQTtBQUFBLElBQVksT0FBQSxDQUFaLGlCQUFZLENBQVo7QUFFQSxDQUFBO0FBQUEsRUFBQSxJQUFBO0FBQUEsRUFBQTtBQUFBLElBQWdCLE9BQUEsQ0FBaEIsaUJBQWdCLENBQWhCO0FBQ0EsQ0FBQTtBQUFBLEVBQUE7QUFBQSxJQUFZLE9BQUEsQ0FBWixnQkFBWSxDQUFaO0FBRUEsSUFBSSxDQUFKLFFBQUEsQ0FBQSxTQUFBLEVBQXlCLFVBQUEsT0FBQSxFQUFBO1NBQ3ZCLE9BQU8sQ0FBUCxJQUFBLENBQUEsZUFBQSxFQUE4QixhQUFBO0FBQzVCLFFBQUEsS0FBQSxFQUFBLE9BQUE7QUFBQSxLQUFBO0FBQUEsTUFBQSxLQUFBO0FBQUEsTUFBQTtBQUFBLFFBQW1CLE9BQUEsQ0FBUTtBQUFBLE1BQUEsS0FBQSxFQUFPO0FBQVAsS0FBUixDQUFuQjtBQUNBLElBQUEsWUFBQSxDQUFhLFlBQUE7YUFBRyxLQUFLLENBQUwsS0FBQSxHQUFjLEM7QUFBOUIsS0FBQSxDQUFBO0FBQ0EsSUFBQSxNQUFNLENBQU4sU0FBQSxDQUFpQjtBQUFBLE1BQUEsS0FBQSxFQUFPO0FBQVAsS0FBakIsRUFDRSxLQUFBLEVBQU0sTUFBTSxJQUFBLENBRGQsT0FDYyxDQUFaLEVBREY7O0FBR0csS0FBQSxVQUFBLEtBQUEsRUFBQSxPQUFBLEVBQUE7YUFDRCxPQUFPLENBQVAsSUFBQSxDQUFBLHNCQUFBLEVBQXFDLGFBQUE7QUFDbkMsU0FBQTtBQUFBLFVBQUEsS0FBQTtBQUFBLFVBQUE7QUFBQSxZQUFtQixPQUFBLENBQVE7QUFBQSxVQUFBLEtBQUEsRUFBTztBQUFBLFlBQUEsS0FBQSxFQUFPO0FBQVA7QUFBUCxTQUFSLENBQW5CO0FBQ0EsUUFBQSxZQUFBLENBQWEsWUFBQTtpQkFBRyxLQUFLLENBQUMsS0FBTixDQUFBLEtBQUEsR0FBb0IsQztBQUFwQyxTQUFBLENBQUE7ZUFDQSxNQUFNLENBQU4sU0FBQSxDQUFpQjtBQUFBLFVBQUEsS0FBQSxFQUFPO0FBQUEsWUFBQSxLQUFBLEVBQU87QUFBUDtBQUFQLFNBQWpCLEVBQ0UsS0FBQSxFQUFNLE1BQU0sSUFBQSxDQURkLE9BQ2MsQ0FBWixFQURGLEM7QUFIRixPQUFBLEM7QUFERixLQUFHLEVBQUgsS0FBRyxFQUFILE9BQUc7O1dBT0EsVUFBQSxLQUFBLEVBQUEsT0FBQSxFQUFBO2FBQ0QsT0FBTyxDQUFQLElBQUEsQ0FBQSxZQUFBLEVBQTJCLGFBQUE7QUFDekIsU0FBQTtBQUFBLFVBQUEsS0FBQTtBQUFBLFVBQUE7QUFBQSxZQUFtQixPQUFBLENBQVEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQTNCLENBQTJCLENBQVIsQ0FBbkI7QUFDQSxRQUFBLFlBQUEsQ0FBYSxZQUFBO2lCQUFHLEtBQUssQ0FBTCxLQUFBLEU7QUFBaEIsU0FBQSxDQUFBO2VBQ0EsTUFBTSxDQUFOLFNBQUEsQ0FBaUIsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBakIsQ0FBaUIsQ0FBakIsRUFDRSxLQUFBLEVBQU0sTUFBTSxJQUFBLENBRGQsT0FDYyxDQUFaLEVBREYsQztBQUhGLE9BQUEsQztBQURGLEtBQUcsQ0FBSCxLQUFHLEVBQUgsT0FBRyxDO0FBYkwsR0FBQSxDO0FBREYsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImFzc2VydCA9IHJlcXVpcmUgXCJhc3NlcnRcIlxuQW1lbiA9IHJlcXVpcmUgXCJhbWVuXCJcbntwcm9taXNlfSA9IHJlcXVpcmUgXCJwYW5kYS1wYXJjaG1lbnRcIlxuXG57bmV4dCwgdmFsdWV9ID0gcmVxdWlyZSBcIi4uL3NyYy9pdGVyYXRvclwiXG57b2JzZXJ2ZX0gPSByZXF1aXJlIFwiLi4vc3JjL29ic2VydmVcIlxuXG5BbWVuLmRlc2NyaWJlIFwiT2JzZXJ2ZVwiLCAoY29udGV4dCkgLT5cbiAgY29udGV4dC50ZXN0IFwiY2hhbmdlIGV2ZW50c1wiLCAtPlxuICAgIHtwcm94eSwgcmVhY3Rvcn0gPSBvYnNlcnZlIHZhbHVlOiA3XG4gICAgc2V0SW1tZWRpYXRlIC0+IHByb3h5LnZhbHVlID0gM1xuICAgIGFzc2VydC5kZWVwRXF1YWwgdmFsdWU6IDMsXG4gICAgICB2YWx1ZSB5aWVsZCBuZXh0IHJlYWN0b3JcblxuICAgIGRvIChwcm94eSwgcmVhY3RvcikgLT5cbiAgICAgIGNvbnRleHQudGVzdCBcIm5lc3RlZCBjaGFuZ2UgZXZlbnRzXCIsIC0+XG4gICAgICAgIHtwcm94eSwgcmVhY3Rvcn0gPSBvYnNlcnZlIHZhbHVlOiB2YWx1ZTogN1xuICAgICAgICBzZXRJbW1lZGlhdGUgLT4gcHJveHkudmFsdWUudmFsdWUgPSA1XG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwgdmFsdWU6IHZhbHVlOiA1LFxuICAgICAgICAgIHZhbHVlIHlpZWxkIG5leHQgcmVhY3RvclxuXG4gICAgZG8gKHByb3h5LCByZWFjdG9yKSAtPlxuICAgICAgY29udGV4dC50ZXN0IFwiZm9yIGFycmF5c1wiLCAtPlxuICAgICAgICB7cHJveHksIHJlYWN0b3J9ID0gb2JzZXJ2ZSBbMS4uNV1cbiAgICAgICAgc2V0SW1tZWRpYXRlIC0+IHByb3h5LnNoaWZ0KClcbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbCBbMi4uNV0sXG4gICAgICAgICAgdmFsdWUgeWllbGQgbmV4dCByZWFjdG9yXG4iXSwic291cmNlUm9vdCI6IiJ9
//# sourceURL=/Users/dyoder/repos/panda-river/test/observe.coffee